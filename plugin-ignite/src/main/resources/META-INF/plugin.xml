<idea-plugin>
    <id>com.checkmarx.devassist-jetbrains-plugin</id>
    <name>Checkmarx Developer Assist</name>
    <vendor email="support@checkmarx.com" url="https://www.checkmarx.com">Checkmarx</vendor>

    <description><![CDATA[
    Checkmarx Ignite provides real-time security scanning powered by DevAssist technology.
    Get instant feedback on security vulnerabilities, secrets, IaC misconfigurations, and more as you code.
    ]]></description>

    <!-- Dependencies -->
    <depends>com.intellij.modules.platform</depends>

    <!-- Extensions -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Main Settings (from common-lib) -->
        <applicationConfigurable instance="com.checkmarx.intellij.common.settings.global.GlobalSettingsConfigurable"/>
        <applicationService serviceImplementation="com.checkmarx.intellij.common.settings.global.GlobalSettingsState"/>
        <applicationService serviceImplementation="com.checkmarx.intellij.common.settings.global.GlobalSettingsSensitiveState"/>

        <!-- DevAssist Settings (from common-lib) -->
        <applicationConfigurable provider="com.checkmarx.intellij.common.settings.global.CxOneAssistConfigurableProvider"/>

        <!-- Project Services (from common-lib) -->
        <projectService serviceImplementation="com.checkmarx.intellij.common.project.ProjectResultsService"/>

        <!-- DevAssist Services (from devassist-lib) -->
        <projectService serviceImplementation="com.checkmarx.intellij.common.devassist.problems.ProblemHolderService"/>
        <projectService serviceImplementation="com.checkmarx.intellij.common.devassist.registry.ScannerRegistry"/>

        <!-- Startup Activities -->
        <postStartupActivity implementation="com.checkmarx.intellij.common.startup.LicenseFlagSyncStartupActivity"/>
        <postStartupActivity implementation="com.checkmarx.intellij.common.devassist.configuration.mcp.McpInstallService"/>
        <postStartupActivity implementation="com.checkmarx.intellij.common.devassist.configuration.GlobalScannerStartupActivity"/>

        <!-- Tool Window (DevAssist Only) -->
        <toolWindow id="Checkmarx Developer Assist"
                    anchor="bottom"
                    icon="com.checkmarx.intellij.common.resources.CxIcons.CHECKMARX_13"
                    factoryClass="com.checkmarx.intellij.ignite.window.IgniteToolWindowFactory"/>

        <!-- DevAssist Inspection (from devassist-lib) -->
        <localInspection language="" 
                         displayName="CxOneAssist"
                         groupName="Checkmarx"
                         enabledByDefault="true"
                         level="WARNING"
                         implementationClass="com.checkmarx.intellij.common.devassist.inspection.CxOneAssistInspection"/>

        <!-- DevAssist Remediation Link Handler (from devassist-lib) -->
        <codeInsight.linkHandler prefix="#cxonedevassist/"
                                 handlerClass="com.checkmarx.intellij.common.devassist.remediation.RemediationLinkHandler"/>

        <!-- Notifications -->
        <notificationGroup id="Checkmarx.Notifications" displayType="BALLOON"/>
    </extensions>

    <!-- Application Listeners (from common-lib) -->
    <applicationListeners>
        <listener class="com.checkmarx.intellij.common.project.ProjectListener"
                  topic="com.intellij.openapi.project.ProjectManagerListener"/>
        <listener class="com.checkmarx.intellij.devassist.configuration.mcp.McpUninstallHandler"
                  topic="com.intellij.ide.plugins.DynamicPluginListener"/>
    </applicationListeners>

    <!-- Actions are added dynamically by the tool window -->
</idea-plugin>

