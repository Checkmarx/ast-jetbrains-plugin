<idea-plugin>
    <id>com.checkmarx.devassist-jetbrains-plugin</id>
    <name>Checkmarx Developer Assist</name>
    <vendor email="support@checkmarx.com" url="https://www.checkmarx.com">Checkmarx</vendor>

    <description><![CDATA[
    Checkmarx Developer Assist an advanced security agent that delivers real-time context-aware prevention, remediation, and guidance to developers from the IDE.
    It provides real-time security scanning and get instant feedback on security vulnerabilities, secrets, IaC misconfigurations, and more as you code.

    <b>Checkmarx Developer Assist â€“ Features.</b>
        <ul>
            <li><b>OSS</b> Realtime scanner identifies risks in open source packages used in your project.</li>
            <li><b>Secrets</b> Realtime scanner identifies risks in detected secrets used in your project.</li>
            <li><b>Container</b> Realtime scanner identifies risks in container images used in your project.</li>
            <li><b>IAC</b> Realtime scanner identifies infrastructure configuration risks in your project.</li>
            <li><b>ASCA</b> Realtime scanner identifies insecure patterns in your project source code.</li>
            <li>MCP-based agentic AI remediation.</li>
            <li>AI-powered explanation of risk details.</li>
        </ul>
    ]]></description>

    <!-- Dependencies -->
    <depends>com.intellij.modules.platform</depends>

    <!-- Extensions -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Main Settings (from common-lib) -->
        <applicationConfigurable instance="com.checkmarx.intellij.ignite.settings.IgniteSettingsConfigurable"/>
        <applicationService serviceImplementation="com.checkmarx.intellij.common.settings.GlobalSettingsState"/>
        <applicationService serviceImplementation="com.checkmarx.intellij.common.settings.GlobalSettingsSensitiveState"/>

        <!-- DevAssist Settings (from common-lib) -->
        <applicationConfigurable provider="com.checkmarx.intellij.devassist.settings.CxOneAssistConfigurableProvider"/>

        <!-- Startup Activities -->
        <!-- Sync license flags from server on IDE startup to ensure UI shows correct panels -->
        <postStartupActivity implementation="com.checkmarx.intellij.common.startup.LicenseFlagSyncStartupActivity"/>
        <!-- Auto-install MCP at IDE startup if already authenticated -->
        <postStartupActivity implementation="com.checkmarx.intellij.devassist.configuration.mcp.McpInstallService"/>
        <postStartupActivity implementation="com.checkmarx.intellij.devassist.configuration.GlobalScannerStartupActivity"/>

        <!-- Tool Window (DevAssist Only) -->
        <toolWindow id="Checkmarx Developer Assist"
                    anchor="bottom"
                    icon="com.checkmarx.intellij.common.resources.CxIcons.CHECKMARX_13"
                    factoryClass="com.checkmarx.intellij.ignite.window.IgniteToolWindowFactory"/>

        <!-- DevAssist Inspection (from devassist-lib) -->
        <localInspection language="" 
                         displayName="CxOneAssist"
                         groupName="Checkmarx"
                         enabledByDefault="true"
                         level="WARNING"
                         implementationClass="com.checkmarx.intellij.devassist.inspection.CxOneAssistInspection"/>

        <!-- DevAssist Remediation Link Handler (from devassist-lib) -->
        <codeInsight.linkHandler prefix="#cxonedevassist/"
                                 handlerClass="com.checkmarx.intellij.devassist.remediation.RemediationLinkHandler"/>

        <!-- Notifications -->
        <notificationGroup id="Checkmarx.Notifications" displayType="BALLOON"/>
    </extensions>

    <!-- Application Listeners (from common-lib) -->
    <applicationListeners>
        <listener class="com.checkmarx.intellij.devassist.listeners.ProjectListener"
                  topic="com.intellij.openapi.project.ProjectManagerListener"/>
        <listener class="com.checkmarx.intellij.devassist.configuration.mcp.McpUninstallHandler"
                  topic="com.intellij.ide.plugins.DynamicPluginListener"/>
    </applicationListeners>

    <!-- Actions are added dynamically by the tool window -->
</idea-plugin>

