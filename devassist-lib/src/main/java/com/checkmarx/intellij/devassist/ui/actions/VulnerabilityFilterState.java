package com.checkmarx.intellij.devassist.ui.actions;

import com.checkmarx.intellij.common.settings.GlobalSettingsState;
import com.checkmarx.intellij.common.window.actions.filter.Filterable;

import java.util.Collections;
import java.util.HashSet;
import java.util.Set;

/**
 * Holds filter state (set of Filterables) for the CxFindingsWindow tab.
 */
public class VulnerabilityFilterState {
    private static final VulnerabilityFilterState INSTANCE = new VulnerabilityFilterState();

    private final Set<Filterable> selectedFilters = Collections.synchronizedSet(new HashSet<>());

    private VulnerabilityFilterState() {
        // Initialize selectedFilters with global default filters on first load
        Set<Filterable> globalDefaults = GlobalSettingsState.getInstance().getFilters();
        if (selectedFilters.isEmpty()) {
            selectedFilters.addAll(globalDefaults);
        }
    }


    public static VulnerabilityFilterState getInstance() {
        return INSTANCE;
    }

    public Set<Filterable> getFilters() {
        if (selectedFilters.isEmpty()) {
            selectedFilters.addAll(GlobalSettingsState.getInstance().getFilters());
        }
        return selectedFilters;
    }
}